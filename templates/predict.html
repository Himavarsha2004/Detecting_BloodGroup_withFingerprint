<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Bloodgroup Detector</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/predictstyle.css') }}">

  <style>
    @media print {
      /* Hide everything except the result card */
      body * {
        visibility: hidden;
      }
      #resultCard, #resultCard * {
        visibility: visible;
      }
      #resultCard {
        position: absolute;
        top: 0;
        left: 0;
      }
    }
  </style>
</head>
<body style="background-image: url('{{ background_image_url }}'); background-size: cover; background-repeat: no-repeat; background-position: center; background-attachment: fixed;">

  <!-- Navbar -->
  <nav class="navbar">
    <div class="logo">
      <img src="https://cdn-icons-png.flaticon.com/512/1086/1086933.png" alt="logo">
      <span>Bloodgroup Detector</span>
    </div>
    <div class="nav-links">
      <a href="{{ url_for('home') }}">Home</a>
      <a href="{{ url_for('about') }}">About</a>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero" id="heroSection">
    <h1>Upload fingerprint to check</h1>
    <p>New way of Detecting Blood Group with Fingerprint</p>
    <div class="hero-buttons">
      <button class="hero-btn" onclick="scrollToForm()">Predict</button>
    </div>
    <img src="{{ url_for('static', filename='images/pic4.jpg') }}" alt="Fingerprint" class="hero-image">
  </section>

  <!-- Form Section -->
<section class="form-section" id="formSection">
  <div class="form-container">
    <h2>Blood Group Detection Form</h2>
    <form id="bloodForm" enctype="multipart/form-data">
      <div class="form-group">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required>
      </div>
      <div class="form-group">
        <label for="mobile">Mobile Number:</label>
        <input type="tel" id="mobile" name="mobile" required>
      </div>
      <div class="form-group">
        <label for="gender">Gender:</label>
        <select id="gender" name="gender" required>
          <option value="">Select Gender</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Other">Other</option>
        </select>
      </div>
      <div class="form-group">
        <label for="age">Age:</label>
        <input type="number" id="age" name="age" required>
      </div>
      <div class="form-group">
        <label for="fingerprint">Upload Fingerprint:</label>
        <input type="file" id="fingerprint" name="fingerprint" accept="image/*" required>
      </div>
      <button type="submit" class="submit-btn">Detect Blood Group</button>
    </form>
  </div>
</section>

<!-- Result Section (Separate) -->
<section class="result-section" id="resultCard" style="display: none;">
  <h3>Prediction Result</h3>
  
  <img id="uploadedImage" src="#" alt="Uploaded Fingerprint" style="max-width: 200px; margin-bottom: 20px;">

  <table border="1" cellpadding="10" cellspacing="0" style="border-collapse: collapse; background-color: #fff;">
    <tr>
      <th>Name</th>
      <td id="resultName"></td>
    </tr>
    <tr>
      <th>Mobile</th>
      <td id="resultMobile"></td>
    </tr>
    <tr>
      <th>Gender</th>
      <td id="resultGender"></td>
    </tr>
    <tr>
      <th>Age</th>
      <td id="resultAge"></td>
    </tr>
    <tr>
      <th>Blood Group</th>
      <td id="resultBloodGroup"></td>
    </tr>
    <tr>
      <th>Confidence</th>
      <td id="resultConfidence"></td>
    </tr>
  </table>

  <button onclick="window.print()" style="margin-top: 20px; padding: 10px 16px; background-color: green; color: white; border: none; border-radius: 5px; cursor: pointer;">Print Result</button>
</section>



  <script>
    function scrollToForm() {
      document.getElementById('formSection').scrollIntoView({ behavior: 'smooth' });
    }

    document.getElementById('bloodForm').addEventListener('submit', async function(e) {
  e.preventDefault();

  const formData = new FormData(this);
  const fileInput = document.getElementById('fingerprint');

  const response = await fetch('/predict', {
    method: 'POST',
    body: formData
  });

  const result = await response.json();

  if (result.error) {
    alert(result.error);
  } else {
    // Fill result values
    document.getElementById('resultName').textContent = result.name;
    document.getElementById('resultMobile').textContent = result.mobile;
    document.getElementById('resultGender').textContent = result.gender;
    document.getElementById('resultAge').textContent = result.age;
    document.getElementById('resultBloodGroup').textContent = result.bloodgroup;
    document.getElementById('resultConfidence').textContent = result.confidence.toFixed(2);

    // Show image preview
    const reader = new FileReader();
    reader.onload = function(e) {
      document.getElementById('uploadedImage').src = e.target.result;
    };
    reader.readAsDataURL(fileInput.files[0]);

    // Show and scroll to result
    document.getElementById('resultCard').style.display = 'block';
    document.getElementById('resultCard').scrollIntoView({ behavior: 'smooth' });

    document.querySelector('.print-btn').addEventListener('click', function() {
    window.print();
  });
  }
});

  </script>

</body>
</html>
